Ext.ns("SF.framework"),SF.core=SF.framework.core=function(){function a(a,b,c){a=a.toLowerCase();var d={name:a,fn:b,scope:c||window};k[a]=d}function b(a){Ext.isString(a)?(a=a.toLowerCase(),delete k[a]):k={}}function c(a){var b=Array.prototype.slice.call(arguments,1);l.hasOwnProperty(a)?Ext.isFunction(l[a].on)?l[a].on.apply(l[a],b):SF.error("\u4e0d\u662f\u5408\u6cd5\u7684\u4e8b\u4ef6\u5bf9\u8c61"):(m[a]=m[a]||[],m[a].push(Array.prototype.slice.call(arguments,0)))}function d(a){var b,c,d,e=Array.prototype.slice.call(arguments,1);l.hasOwnProperty(a)?Ext.isFunction(l[a].un)?l[a].un.apply(l[a],e):SF.error("\u4e0d\u662f\u5408\u6cd5\u7684\u4e8b\u4ef6\u5bf9\u8c61"):(b=[],m.hasOwnProperty(a)&&Ext.each(m[a],function(f){if(1===f.length){var g,h,i=f[0],j=e[0];i.hasOwnProperty(j)&&(g=i[j].fn||i[j],h=i[j].scope||i.scope,j===f[0]&&g===f[1]&&h===f[2]&&b.push(f))}else{for(c=!0,d=0;3>d;d++)f[d]!==e[d]&&(c=!1);c&&b.push(a)}}),Ext.each(b,function(a){m.remove(a)}))}function e(a,b){var d;l[a]=b,m.hasOwnProperty(a)&&(d=c,Ext.each(m[a],function(a){d.apply(this,a)},this),delete m[a])}function f(a){if(a=a.toLowerCase(),k.hasOwnProperty(a)){var b=k[a];return b.fn.apply(b.scope||window,Array.prototype.slice.call(arguments,1))}return SF.log("Global invoke: "+a),!1}function g(a,b){n.push({fn:a,scope:b})}function h(a,b,c){j.isReady?(o.addListener(a,b,c),o.fire(),o.listeners=[]):(c=c||{},c.delay=c.delay||1,o.addListener(a,b,c))}function i(){SF.time("Framework core begin init.");var a,b,c,d,e,f,g=n;if(n=[],a=g.slice(0),f=function(){return a.length<=0?(j.isReady=!0,o.fire(),o.listeners=[],!0):!1},e=function(b){a.remove(b),f()},!f())for(b=0,c=g.length;c>b;b++)d=g[b],!0===d.fn.call(d.scope||window,e.createCallback(d))&&e(d)}var j,k={},l={},m={},n=[],o=new Ext.util.Event;return j={isReady:!1,regDependentTask:g,onReady:h,init:i,regInvoke:a,clearInvoke:b,invoke:f,regEventSource:e,onEvent:c,unEvent:d}}(),Ext.apply(SF.framework.core,new Ext.util.Observable),Ext.onReady(SF.framework.core.init,SF.framework.core),SF.invoke=SF.framework.core.invoke,SF.onEvent=SF.framework.core.onEvent,Ext.ns("SF.framework"),SF.debug=SF.framework.debug=SF.debugMode?function(){function a(){h.component=Ext.ComponentMgr.all,h.element=Ext.elCache,h.store=Ext.StoreMgr,h.dragdrop=Ext.dd.DragDropMgr.ids}function b(a,b){b=b||"id";var c=[];if(Ext.isFunction(a.each)&&a.keys)return[].concat(a.keys);if(a.length)for(var d=0;d<a.length;d++)c.push(a[d][b]);else for(var e in a)a.hasOwnProperty(e)&&a[e]&&!SF.isEmptyObject(a[e])&&c.push(e);return c}function c(){a();var c=[];return j={},Ext.iterate(h,function(a,d){j[a]=b(d).length,c.push(a+" : "+j[a])}),SF.log(c.join(", ")),c.join("\n")}function d(a,b){a=a.sort(),b=b.sort();for(var c,d,e=[],f=[],g=0,h=0;;){if(c=a[g]||null,d=b[h]||null,null===c&&null===d)break;null===c||c>d?(f.push(b[h]),h++):null===d||d>c?(e.push(a[g]),g++):(g++,h++)}return[e,f]}function e(){a();var c={},e=[];return Ext.iterate(h,function(a,d){c[a]=b(d)}),i&&Ext.iterate(i,function(a,b){var f=d(b,c[a]);e.push(a+" : "+(f[0].length>0?" del["+f[0].join(",")+"]":"")+(f[1].length>0?" new["+f[1].join(",")+"]":""))}),i=c,SF.log(e.join("\n")),e.join("\n")}function f(a,b){a&&(b=b||"noname",a.__monitorDom=document.createElement("em"),a.__monitorDom.id="DEBUG-MONITOR-"+ ++k+"-"+b)}if(SF.ajaxTimer){var g="__timer";Ext.Ajax.on("beforerequest",function(a,b){b[g]=new Date}),Ext.Ajax.on("requestcomplete",function(a,b,c){SF.log(String.format("{0} {1} success {2}",new Date-c[g],c.method||"GET",c.url)),delete c[g]}),Ext.Ajax.on("requestexception",function(a,b,c){SF.log(String.format("{0} {1} failure {2}",new Date-c[g],c.method||"GET",c.url)),delete c[g]})}Ext.util.MixedCollection=SF.sequenceConstructor(Ext.util.MixedCollection,function(){SF.framework.debug.monitor(this,"MixedCollection")}),Ext.override(Ext.util.MixedCollection,{cleanClear:function(){this.map=SF.clean(this.map)}});var h={},i=null,j={},k=1e4,l={recordExtStatus:function(){alert(e())},getKeys:b,getExtCounts:function(){alert(c())},monitor:f,cleanClear:SF.clean,interceptor:function(a,b){var c=a[b];a[b]=function(){c.apply(a,arguments)}}};return l}():{},function(){function a(a){return!isNaN(parseFloat(a))&&isFinite(a)}function b(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=b.replace(/^\?/,"").split("&"),s={};for(h=0,i=r.length;i>h;h++)if(j=r[h],j.length>0)if(e=j.split("="),f=decodeURIComponent(e[0]),g=void 0!==e[1]?decodeURIComponent(e[1]):"",c){if(m=f.match(/(\[):?([^\]]*)\]/g),n=f.match(/^([^\[]+)/),f=n[0],o=[],null===m){s[f]=g;continue}for(k=0,l=m.length;l>k;k++)p=m[k],p=2===p.length?"":p.substring(1,p.length-1),o.push(p);for(o.unshift(f),d=s,k=0,l=o.length;l>k;k++)p=o[k],k===l-1?Ext.isArray(d)&&""===p?d.push(g):d[p]=g:((void 0===d[p]||"string"==typeof d[p])&&(q=o[k+1],d[p]=a(q)||""===q?[]:{}),d=d[p])}else s.hasOwnProperty(f)?(Ext.isArray(s[f])||(s[f]=[s[f]]),s[f].push(g)):s[f]=g;return s}function c(a){var b,c,d,e,f=/^#mod=([\/a-zA-Z\d_\-]+)(?:#group=(\w+))?(?:#data=(.*))?$/,g={};if(!a)return g;if(b=decodeURIComponent(a).match(f),!b)return g;c=b[1],d=b[2],e=b[3],c&&(g.mod=c,g.group=d);try{g.data=Ext.decode(e)}catch(h){g.data={}}return g}Ext.ns("SF.framework");var d=location.search;SF.framework.Location={fromQueryString:function(){return b(d,!1)},fromHashString:function(a){return c(a)}}}(),function(){var a=SF.framework.Location.fromHashString(location.hash);a&&a.mod?(SF.defaultPage=a.mod,SF.defaultPageGroup=a.group||"group-"+ +new Date,SF.defaultPageParams=a.data):(SF.defaultPage="/mod-index/index",SF.defaultPageGroup=a.group||"group-"+ +new Date,SF.defaultPageParams={}),SF.defaultPage="home"+SF.defaultPage}(),function(){function a(c){Ext.Ajax.request({url:ACDC.data.url,jsonData:{app_args:{name:"app.web.auth.page_info",options:{}},opr:"page_info"},success:function(a){var b=a.getJsonData();ACDC.config({leftTree:b}),SF.time("Left tree load complete."),c()},failure:function(){b++,3>b?(SF.log(b),a.defer(3e3,window,[c])):(SF.time("Left tree load failure."),c())}})}var b=0;SF.core.regDependentTask(a)}(),Ext.ns("SF.framework"),SF.loader=SF.framework.loader=function(){return{loadJs:function(a,b){if(Ext.isArray(a)){var c=a.slice();SF.loader.loadJs(c.shift(),function(){c.length?SF.loader.loadJs(c,b):b.apply(this,arguments)})}else seajs.use(a,b)}}}(),SF.framework.core.loadJs=SF.framework.loader.loadJs,Ext.ns("SF.framework"),SF.module=SF.framework.module=function(){function a(a){for(var b=a.split("."),c=window,d=0;c&&d<b.length;d++)c=c[b[d]];return c||null}var b,c={};return b={get:function(b){return c.hasOwnProperty(b)?c[b]:a(b)?a(b):null},register:function(b){if(b.xname){c[b.xname]=b;var d=b.xname.lastIndexOf("."),e="SF."+b.xname.slice(0,d),f=b.xname.slice(d+1);SF.ns(e);var g=a(e);return g[f]=b,!0}return SF.error("\u9875\u9762\u672a\u5b9a\u4e49xname."),!1},loadModule:function(a,b,c){b=b||SF.emptyFn;var d=function(d){d&&(d.xname=d.xname||a,SF.core.register(d)),b.call(c||window,d)};SF.framework.core.loadJs(a,d)}}}(),SF.framework.core.register=SF.module.register,SF.framework.core.getModule=SF.module.get,SF.framework.core.loadModule=SF.module.loadModule,Ext.ns("SF.framework"),SF.PageWrap=SF.framework.PageWrap=Ext.extend(Ext.Container,{module:null,isWindowContainer:!0,isTipContainer:!0,layout:"fit",cls:"sf-page-wrap",constructor:function(a,b){if(SF.framework.PageWrap.superclass.constructor.call(this,b),this.module=a,this.module.relayEvents(this,["activate","deactivate","beforeclose"]),a.setContainer(this),this.on("afterlayout",this.module.afterWrapLayout,this.module,{single:!0}),SF.pageTimer&&this.on("afterlayout",function(a){SF.time(String.format("[{0}] Layout finished. (id:{1})",this.module.getXName(),a.getId()),"pageTimer")},this),SF.debugMode)this._doModuleInit();else try{this._doModuleInit()}catch(c){SF.error("["+this.module.getXName()+"]Page init&layout error!",c),SF.alert(_("\u9875\u9762\u521d\u59cb\u5316\u53ca\u5e03\u5c40\u51fa\u9519!")),this.title="Init&Layout Error!"}SF.pageTimer&&SF.time(String.format("[{0}] Page combine finished.",this.module.getXName()),"pageTimer")},_doModuleInit:function(){var a=this,b=function(){a.module.init(),a.module.layout(a),a.hasLayout&&a.doLayout()};this.title=_("\u521d\u59cb\u5316\u4e2d..."),this.module.beforeInit(b)===!0&&b()},onDestroy:function(){if(this.module&&this.module.destroying!==!0&&this.module.isDestroyed!==!0)try{Ext.destroy(this.module)}catch(a){SF.error("["+this.module.getXName()+"]Page destroy error!",a),SF.alert(_("\u9875\u9762\u9500\u6bc1\u51fa\u9519!"))}SF.log("["+this.module.getXName()+"]PageWrap destroy."),SF.framework.PageWrap.superclass.onDestroy.call(this)}}),function(){var a=Ext.extend(SF.framework.PageWrap,{bActive:!1,constructor:function(){SF.framework.PageWrap.superclass.constructor.apply(this,arguments),this.addEvents("pageload"),this.on({scope:this,afterrender:this.delayLoadPage,activate:this.activate,deactivate:this.deactivate})},delayLoadPage:function(){var a,b=this,c=b.moduleName,d=b.moduleConfig,e=SF.core.getModule(c);b.pendingTask&&b.pendingTask.clear(),b.pendingTask={clear:function(){a=Ext.emptyFn,b.pendingTask=null}},a=function(){var a=new e(d);b.compositePage(a),b.pendingTask.clear()},e?a():SF.core.loadModule(c,function(b){b?(e=SF.core.getModule(c),a()):(SF.alert(_("\u52a0\u8f7d\u9875\u9762\u51fa\u9519\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u8fde\u63a5\u662f\u5426\u6b63\u5e38\u3002")),SF.error(_("\u52a0\u8f7d\u9875\u9762[{0}]\u51fa\u9519\uff01",c)))},this)},activate:function(){this.bActive=!0},deactivate:function(){this.bActive=!1},compositePage:function(a){if(this.module=a,a.relayEvents(this,["activate","deactivate","beforeclose"]),a.setContainer(this),this.on("afterlayout",a.afterWrapLayout,a,{single:!0}),SF.debugMode)this._doModuleInit();else try{this._doModuleInit()}catch(b){SF.error("["+a.getXName()+"]Page init&layout error!",b),SF.alert(_("\u9875\u9762\u521d\u59cb\u5316\u53ca\u5e03\u5c40\u51fa\u9519!")),this.title="Init&Layout Error!"}a.fireEvent(this.bActive?"activate":"deactivate",a),this.fireEvent("pageload",a)},onDestroy:function(){this.pendingTask&&this.pendingTask.clear();var a=this.module;if(a&&a.destroying!==!0&&a.isDestroyed!==!0)try{Ext.destroy(this.module)}catch(b){SF.error("["+this.module.getXName()+"]Page destroy error!",b),SF.alert(_("\u9875\u9762\u9500\u6bc1\u51fa\u9519!"))}SF.log("["+(a?a.getXName():"Loading")+"]PageWrap destroy."),SF.framework.PageWrap.superclass.onDestroy.call(this)}});Ext.ns("SF.framework"),SF.framework.DeferPageWrap=a}(),function(){Ext.ns("SF.framework"),SF.framework.BasePageMgr=function(){SF.framework.BasePageMgr.superclass.constructor.call(this),this.addEvents("beforepagedestroy","add","remove","pagechange")},Ext.extend(SF.framework.BasePageMgr,Ext.util.Observable,{find:function(){},add:function(){},insert:function(){},replace:function(){},remove:function(){},activate:function(){},getActive:function(){},getCount:function(){}});var a=Ext.extend(Ext.Container,{border:!1,layout:"card",height:"100%",width:"100%"});SF.framework.PageMgr=function(a){SF.framework.PageMgr.superclass.constructor.call(this),a=a||{},this.initPageMgr(),this.pages=new Ext.util.MixedCollection(!1,this.getKey),this.mainTab.on("add",this.onAddPage,this,{target:this.mainTab}),this.mainTab.on("remove",this.onRemovePage,this,{target:this.mainTab}),this.mainTab.on("add",this.finalizePageMgr,this,{target:this.mainTab,single:!0}),this.mainTab.on("tabchange",this._handleTabChange,this)},Ext.extend(SF.framework.PageMgr,SF.framework.BasePageMgr,{initPageMgr:function(){SF.core.regInvoke("getActivePage",this.getActive,this);var b=this.mainTab=new a({id:"sf_main_tabpanel",margins:"0 0 0 0",region:"center",activeItem:0,items:[]});this.view=b},finalizePageMgr:function(){var a=this.mainTab.getComponent("__sf_main_tab_todelete");this.mainTab.remove(a),this.mainTab.layout.setActiveItem(0)},getKey:function(a){return a.getContainer().getItemId()},_handleTabChange:function(a,b){var c;c=b?b.module:null,c&&this.fireEvent("pagechange",c)},onRemovePage:function(a,b){if(b.module){var c=b.module;this.pages.remove(c),this.fireEvent("remove",c)}},onAddPage:function(a,b,c){if(b.module){var d=b.module;this.pages.insert(c,d),this.fireEvent("add",d)}},beforePageDestroy:function(a){return this.fireEvent("beforepagedestroy",a.module)},initWrap:function(a){var b=a.getContainer();return b||(b=new SF.PageWrap(a),b.on("beforedestroy",this.beforePageDestroy,this)),b.closable=this.getCount()>0?a.closable!==!1:!1,a.setContainer(b),b},getCount:function(){return this.pages.length||0},find:function(a){var b,c=this.pages.items;if(SF.isString(a)){for(b=0;b<c.length;b++)if(c[b].getXName()===a)return c[b]}else{if(SF.isNumber(a))return c[b];if(a&&a.getContainer)return a}return null},add:function(a){var b=this.initWrap(a);return this.mainTab.add(b),a},insert:function(a,b){var c=this.initWrap(b);return this.mainTab.insert(a,c),b},replace:function(a,b){var c,d,e=-1,f=this;if(arguments.length<2){if(b=a,c=this.mainTab.layout.activeItem,a=c&&c.module||!1,!a){var g=this.add(b);return g}}else Ext.isNumber(a)?(e=a,c=this.mainTab.items.getAt(e),a=c.module):c=a.getContainer();return 0>e&&(e=this.mainTab.items.indexOf(c)),b.closable=c.closable,d=function(){f.insert(e,b),f.activate(b),f.mainTab.remove(c,!0),f.pages.remove(a)},!1!==a.fireEvent("beforeclose",a,d)?(d(),b):null},remove:function(a){var b,c=this;return b=function(){c.mainTab.remove(a.getContainer(),!0),c.pages.remove(a)},!1!==a.fireEvent("beforeclose",a,b)?(b(),a):null},activate:function(a){a=this.find(a),this.mainTab.layout.setActiveItem(a.getContainer())},getActive:function(){return this.mainTab.layout.activeItem&&this.mainTab.layout.activeItem.module}})}(),Ext.ns("SF.framework"),SF.framework.BasicViewClass=function(){SF.framework.BasicViewClass.superclass.constructor.call(this)},Ext.extend(SF.framework.BasicViewClass,Ext.util.Observable,{openPage:SF.emptyFn}),SF.framework.MultiPageView=function(a){SF.framework.MultiPageView.superclass.constructor.call(this),a=a||{},this.pageMgr=new SF.framework.PageMgr,this.view=this.pageMgr.view,this.waitMask=!1,this.pageMgr.on("beforepagedestroy",this.handlePageDestroy,this),this.pageMgr.on("remove",this.handlePageRemove,this),this.relayEvents(this.pageMgr,["pagechange"]),this.defaultPage=SF.defaultPage,this.openDefaultPage.defer(100,this),SF.core.regEventSource("view",this),SF.core.regInvoke("openpage",this.openPage,this),SF.core.regInvoke("bufferopenpage",this.bufferOpenPage,this),SF.core.regInvoke("refreshpage",this.refreshPage,this),SF.core.regInvoke("getpagecount",this.getPageCount,this),SF.core.showMsg=this.showMsg,SF.core.showErr=this.showErr},Ext.extend(SF.framework.MultiPageView,SF.framework.BasicViewClass,{openDefaultPage:function(){this.openPage(SF.defaultPage,SF.defaultPageGroup,Ext.apply({closable:!1},SF.defaultPageParams))},showMsg:SF.showMsg,showErr:SF.showErr,getPageCount:function(){return this.pageMgr.getCount()},bufferOpenPage:function(a,b){this.bufferTask||(this.bufferTask=new Ext.util.DelayedTask),this.bufferTask.delay(50,this.openPage,this,[a,b])},handlePageDestroy:function(a){return a.isDestroyed!==!0&&a.destroying!==!0?(a.destroy(5e3),!1):void 0},handlePageRemove:function(){this.pageMgr.pages.getCount()<=0&&this.openDefaultPage()},lookupPage:function(a,b){var c=null,d=SF.emptyFn;if(Ext.isString(a))d=SF.core.getModule(a);else{if(!Ext.isFunction(a))return!1;d=a,a=d.xname}return b=b||{},(c=new d(b))?(SF.pageTimer&&SF.time(String.format("[{0}] Page create finished.",c.getXName()),"pageTimer"),SF.debugMode&&SF.debug&&SF.debug.monitor(c,c.getXName()),c):null},mask:function(a){this.waitMask===!1?(Ext.MessageBox.wait(_("\u52a0\u8f7d\u9875\u9762\u4e2d","\u8bf7\u7a0d\u5019..."),_("\u8bf7\u7a0d\u5019..."),{}),this.waitMask=!0):Ext.isNumber(a)&&Ext.MessageBox.updateProgress(a)},unmask:function(){this.waitMask&&(Ext.MessageBox.updateProgress(1),Ext.MessageBox.hide.defer(100,Ext.MessageBox),this.waitMask=!1)},openPage:function(a,b,c,d){c=c||{};var e,f,g,h=c.newTab||!1,i=c.reload||!1;if(e=SF.core.getModule(a),e&&e.singleton&&(f=this.pageMgr.find(a)))return h=!1,this.fireEvent("activepage",f,a,b||f.getGroupName(),c,h),this.pageMgr.activate(f),f.applyConfig(c),i&&f.reload(),void this.unmask();var j=Ext.applyIf({newTab:h},c);return this.fireEvent("beforeopenpage",a,j)!==!1?(SF.pageTimer&&SF.timeReset("pageTimer"),this.mask(),d!==!1&&null===e?(SF.core.loadModule(a,function(d){d?(this.mask(.6),this.openPage(a,b,c,!1)):(this.unmask(),SF.alert(_("\u52a0\u8f7d\u9875\u9762\u51fa\u9519!")))},this),void this.mask(.2)):(this.mask(.8),e?h?(g=this.lookupPage(e,c),g&&(this.fireEvent("openpage",g,a,b||g.getGroupName(),c,h),this.pageMgr.add(g),this.pageMgr.activate(g)),void this.unmask()):(g=this.lookupPage(e,c),g&&(this.fireEvent("openpage",g,a,b||g.getGroupName(),c,h),this.pageMgr.replace(g)),void this.unmask()):(SF.error("\u627e\u4e0d\u5230\u6b64\u9875\u9762: ["+a+"]"),void this.unmask()))):void 0},refreshPage:function(){var a=this.pageMgr,b=a.getActive(),c=SF.core.getModule(b.getXName());a.replace(new c(b.getOpenConfig()))}}),function(){function a(a,b){var c,d,e,f=a.split("."),g=window;for(c=0,d=f.length-1;d>c;c++)e=f[c],g[e]=g[e]||{},g=g[e];g[f[c]]=b}var b;Ext.ns("SF.framework"),b=SF.framework.globals={stateKey:"_SF_GLOBALS_",vars:{"Ext.Ajax.timeout":{name:_("Ajax\u9ed8\u8ba4\u8d85\u65f6\u65f6\u95f4")},"SF.maxPageCount":{name:_("IE\u4e0b\u6700\u5927\u540c\u65f6\u6253\u5f00\u6807\u7b7e\u6570")}},loadVars:function(b){var c;for(c in b)b.hasOwnProperty(c)&&a(c,b[c])}},SF.core.onReady(function(){var a=Ext.state.Manager.get(b.stateKey,{});b.loadVars(a)})}(),SF.ns("SF.framework"),SF.framework.Viewport=Ext.extend(Ext.util.Observable,{init:function(){this.multiPageView=new SF.framework.MultiPageView({}),this.viewport=new Ext.Viewport({layout:"border",items:[this.navContainer=new Ext.Container({layout:"fit",region:"west",id:"nav",itemId:"nav",width:200,margins:"0 0 0 0",hidden:this.showNav===!1}),this.bodyContainer=new Ext.Panel({border:!1,layout:"border",region:"center",items:[this.headerWrap=new Ext.Container({layout:"anchor",region:"north",height:50,margins:"0 0 0 0",defaults:{anchor:"100%"},items:[this.headerContainer=new Ext.Container({layout:"fit",id:"header",itemId:"header",height:50,hidden:this.showHeader===!1}),this.subHeaderContainer=new Ext.Container({hidden:!0,layout:"fit",id:"sub-header",itemId:"sub_header",height:50})]}),this.multiPageView.view,this.footerContainer=new Ext.Container({layout:"fit",region:"south",id:"footer",itemId:"footer",height:28,margins:"0 0 0 0",hidden:this.showFooter===!1})]})]}),this.isInit=!0,this.fireEvent("init")},getHeader:function(){return this.headerContainer},getSubHeader:function(){return this.subHeaderContainer},getHeaderWrap:function(){return this.headerWrap},getNav:function(){return this.navContainer},getFooter:function(){return this.footerContainer},getPageView:function(){return this.multiPageView},setHeaderVisible:function(a){this.showHeader=a,this.viewport&&(this.getHeader()[a?"show":"hide"](),this.bodyContainer.doLayout())},setNavVisible:function(a){this.showNav=a,this.viewport&&(this.getNav()[a?"show":"hide"](),this.viewport.doLayout())},setFooterVisible:function(a){this.showFooter=a,this.viewport&&(this.getFooter()[a?"show":"hide"](),this.bodyContainer.doLayout())},setSubHeaderVisible:function(a){this.getHeaderWrap().setHeight(a?this.showHeader!==!1?100:50:this.showHeader!==!1?50:0),this.getSubHeader()[a?"show":"hide"](),this.bodyContainer.doLayout()},doLayout:function(a,b){Ext.isFunction(a)&&this.getNav().on("afterlayout",function(){a.call(b,this)},this,{single:!0}),this.viewport.doLayout()}}),SF.core&&(SF.viewport=new SF.framework.Viewport,SF.core.onReady(function(){SF.viewport.init()})),function(){SF.ns("SF.mgr"),SF.mgr.BaseMgr=function(a){SF.apply(this,a),this.initMgr()},SF.mgr.BaseMgr.prototype={mgrType:"base",translateInvalid:!0,autoRefresh:!1,interval:5,autoFinishRefresh:!1,skipFirstRefresh:!0,initMgr:function(){this.windowsCt=this.windowsCt||this.page&&this.page.container||null,this.maskTarget=this.maskTarget||this.windowsCt&&this.windowsCt.getEl&&this.windowsCt.getEl()||this.page||Ext.getBody(),this.page&&(this.page.on("destroy",this.destroyMgr,this),this.autoRefresh&&this.startAutoRefresh(),this.page&&this.simpleView&&(this.page.on("refresh",this.onRefreshNow,this),this.page.on("setrefreshoptions",this.onSetAutoRefreshOptions,this),this.regSingleton("forms.optionwindow",this.createOptionWin,this))),SF.debugMode&&SF.debug&&SF.debug.monitor(this,(this.page?this.page.getXName():this.id||"noname")+"-"+(this.mgrType||"")+"Mgr")},destroy:function(){this.destroyMgr()},destroyMgr:function(){if(!this.isMgrDestroyed){if(this.mgrDestroying=!0,this.onDestroyMgr(),this.stopAutoRefresh(),this.releaseAjaxHandles(),this.singletons){for(var a in this.singletons)this.singletons.hasOwnProperty(a)&&(Ext.destroy(this.singletons[a]),delete this.singletons[a]);delete this.singletons,delete this.singletonCreators}delete this.page,delete this.windowsCt,delete this.maskTarget,this.mgrDestroying=!1,this.isMgrDestroyed=!0}},onDestroyMgr:Ext.emptyFn,bindAction:function(a,b,c,d){SF.ActionMgr.bindAction(a,this,b,c,d)},doExport:function(a,b,c){var d={url:this.url,params:{opr:"export"}};SF.isString(a)?d.url=a:SF.isObject(a)&&SF.apply(d,a),b=SF.isFunction(b)?b.createDelegate(c):function(a,b){a?SF.loadFile(b):this.showErr(_("\u5bfc\u51fa\u6587\u4ef6\u5931\u8d25!"))},d.callback=function(c,d){var e=null;c&&SF.isString(c.url)?e=c.url:d=!1,b.call(this,d,e,a)},this.request(d)},doImport:function(a,b,c,d){var e={url:this.url,params:{opr:"import"}};SF.isString(b)?e.url=b:SF.isObject(b)&&SF.apply(e,b),c=c.createDelegate(d),e.params.file=a,e.callback=function(a,d){c.call(this,d,a,b)},this.request(e)},addWindow:function(a){this.windowsCt?a.setRelatedComponent(this.windowsCt):SF.warn("SF.mgr.BaseMgr::addWindow \u672a\u8bbe\u5b9awindowsCt")},request:function(a){var b,c=this,d={waitMsgTarget:this,scope:this,callback:function(d,e){if(c.isAvailiable()){var f,g,h;f=a.success,g=a.failure,h=a.callback,e?Ext.isFunction(f)?f.call(this,d,a):Ext.isString(f)&&SF.showMsg(f):Ext.isFunction(g)?g.call(this,d,a):Ext.isString(g)&&SF.showMsg(g),Ext.isFunction(h)&&h.call(this,d,e,a),c.unregAjaxHandle(b)}}};return Ext.copyTo(d,a,["url","jsonData","data","params","scope","waitMsg","waitMsgBuffer","waitMsgCls","waitMsgTarget","cancelable","cancelCfg","timeout","headers"]),b=SF.Ajax.jsonRequest(d),this.regAjaxHandle(b),b},abort:function(a){return SF.Ajax.abort(a)},requestUntil:function(a,b,c,d){var e,f=SF.apply({},a),g=SF.emptyFn,h=this;c=SF.isFunction(c)?c.createDelegate(d):function(a){return a&&a.success===!0},b=SF.isNumber(b)?b:3e3,SF.isFunction(a.callback)&&(g=a.callback),e=function(d){g.apply(this,arguments),c.call(this,d,a)!==!0&&h.request.defer(b,h,[f])},f.callback=e,this.request(f)},mask:function(){return this.maskTarget?this.maskTarget.mask.apply(this.maskTarget,arguments):void 0},unmask:function(){return this.maskTarget?this.maskTarget.unmask.apply(this.maskTarget,arguments):void 0},showMsg:function(){SF.showMsg.apply(SF,arguments)},showErr:function(){SF.showErr.apply(SF,arguments)},regAjaxHandle:function(a){this.ajaxHandlePool||(this.ajaxHandlePool={}),this.ajaxHandlePool[a.tId]=a},unregAjaxHandle:function(a){this.ajaxHandlePool||(this.ajaxHandlePool={}),delete this.ajaxHandlePool[a.tId],Ext.isIE&&(this._ajaxDeleteCount=this._ajaxDeleteCount||0,this._ajaxDeleteCount++,this._ajaxDeleteCount>1e3&&(this.ajaxHandlePool=SF.clean(this.ajaxHandlePool)))},releaseAjaxHandles:function(){if(this.ajaxHandlePool)for(var a in this.ajaxHandlePool)this.ajaxHandlePool.hasOwnProperty(a)&&(Ext.Ajax.abort(this.ajaxHandlePool[a]),this.unregAjaxHandle(this.ajaxHandlePool[a]))},createOptionWin:function(){var a=new SF.form.FormWindow({title:_("\u8bbe\u7f6e\u9009\u9879"),width:320,modal:!1,form:new SF.forms.PortalOption});return this.addWindow(a),a},reload:function(){this.load.apply(this,arguments)},load:function(a,b){return b===!1&&this.loading?!1:(this.loading=!0,this.onLoad(a),this.autoFinishRefresh&&this.afterLoad(),void 0)},onLoad:function(){this.afterLoad()},onRefreshNow:function(){this.doRefresh(!0)},setRefreshParams:function(){this.page&&this.page.params&&void 0!==this.page.params.autoRefresh&&this.setAutoRefresh(this.page.params.autoRefresh,this.page.params.interval)},onSetAutoRefreshOptions:function(){var a=this.getAutoRefreshInterval(!0),b=this.isAutoRefreshing(),c={value:{autofresh:{enable:b,intv:a}},confirm:function(a){var b=a.getJsonValue(),c=b.autofresh;return this.setAutoRefresh(c.enable,1e3*c.intv),!0},scope:this},d=this.getSingleton("forms.optionwindow");return d.open(c),!0},doRefresh:function(a){this.isAutoRefreshing()&&this.skipFirstRefresh?(this.skipFirstRefresh=null,this.afterLoad()):this.reload(void 0,a===!0)},toggleAutoRefresh:function(a){this.setAutoRefreshInterval(a),this.isAutoRefreshing()?this.stopAutoRefresh():this.startAutoRefresh()},setAutoRefresh:function(a,b){this.setAutoRefreshInterval(b),a?this.startAutoRefresh():this.stopAutoRefresh()},isAutoRefreshing:function(){return!!this.autoRefreshing},getAutoRefreshInterval:function(a){var b=this.refreshingInterval;return(!Ext.isNumber(b)||0>=b)&&(b=this.interval||this.page&&this.page.interval||5,b*=1e3),a?parseInt(b/1e3,10):b},startAutoRefresh:function(a){if(this.page&&(this.handleResumeAutoRefresh||(this.handleSuspendRefresh=this.suspendAutoRefresh.createDelegate(this,["_page"]),this.handleResumeRefresh=this.resumeAutoRefresh.createDelegate(this,["_page"])),this.page.on("activate",this.handleResumeRefresh,this),this.page.on("deactivate",this.handleSuspendRefresh,this)),Ext.isNumber(a)&&a>0&&this.setAutoRefreshInterval(a),!SF.isObject(this.refreshTsk)){a=this.getAutoRefreshInterval();var b={interval:a,fn:this.doRefresh,scope:this};this.refreshTsk=new SF.util.IntervalTask(b)}this.autoRefreshing=!0,this.autoRefreshSwitches={},(!this.page||this.page.isActive())&&this.refreshTsk.start()},stopAutoRefresh:function(){this.page&&(this.page.un("activate",this.handleSuspendRefresh,this),this.page.un("deactivate",this.handleResumeRefresh,this)),this.autoRefreshing=!1,this.refreshTsk&&this.refreshTsk.stop()},suspendAutoRefresh:function(a){a=Ext.isString(a)?a:"_default",this.autoRefreshSwitches=this.autoRefreshSwitches||{},this.autoRefreshSwitches[a]=!0,this.refreshTsk&&this.refreshTsk.suspend()},resumeAutoRefresh:function(a){a=Ext.isString(a)?a:"_default",this.autoRefreshSwitches=this.autoRefreshSwitches||{},delete this.autoRefreshSwitches[a],this.refreshTsk&&this.isAutoRefreshing()&&SF.isEmptyObject(this.autoRefreshSwitches)&&this.refreshTsk.resume()},setAutoRefreshInterval:function(a){Ext.isNumber(a)&&a>0&&(this.refreshingInterval=a),this.refreshTsk&&this.refreshTsk.setInterval(a,!0)},afterLoad:function(a){this.loading=!1,this.refreshTsk&&this.refreshTsk.finish.defer(1,this.refreshTsk,[a])},regSingleton:function(a,b,c){var d;this.singletonCreators=this.singletonCreators||{},b.getInstance?this.singletonCreators[a]=b.getInstance.createDelegate(b):b.superclass?(d=b,this.singletonCreators[a]=function(){return new d}):this.singletonCreators[a]=b.createDelegate(c)},getSingleton:function(a){if(this.singletons=this.singletons||{},this.singletons.hasOwnProperty(a))return this.singletons[a];if(this.singletonCreators&&this.singletonCreators.hasOwnProperty(a)&&SF.isFunction(this.singletonCreators[a])){var b=this.singletonCreators[a]();return b.singletonName=a,SF.debugMode&&SF.debug&&(SF.debug.monitor(this.singletons,(this.page?this.page.getXName():"")+"-singletons"),SF.debug.monitor(b,(this.page?this.page.getXName():"")+"-"+a)),this.singletons[a]=b,b}return SF.warn("singleton not register: "+a),null},releaseSingleton:function(a){if(a=a.singletonName||a,this.singletons=this.singletons||{},this.singletons.hasOwnProperty(a)){var b=this.singletons[a];Ext.destroy(b),delete this.singletons[a]}},editForm:function(a,b,c){var d=this,e=this.getForm(a);if(!e)return SF.warn("No form"),!1;c=c||{},SF.applyIf(c,{value:b,confirm:function(b,c,e){return d.handleFormConfirm(a,b,c,e)}});var f=function(){e.edit(c),d.onFormEditing(a,b,c,e)};this.beforeFormEdit(a,b,c,e,f)!==!1&&f()},getForm:function(){},beforeFormEdit:function(){},onFormEditing:function(){},handleFormConfirm:function(a,b,c,d){var e=this,f=function(){return e.onFormConfirming(a,b,c,d)};return this.beforeFormConfirm(a,b,c,d,f)!==!1?f():!1},beforeFormConfirm:function(){},onFormConfirming:function(a,b,c,d){return a.editingForm=d,this.submitForm(a,b,{}),!1},submitForm:function(a,b,c){c=c||{};var d=this;SF.applyIf(c,{waitMsg:!0,url:this.url,params:{opr:a.actionName},success:function(b,c,e){a.editingForm&&(a.editingForm.afterSave(),delete a.editingForm),d.onFormSubmitSuccess(a,c,b,e),d.onRequestSuccess(a,b)},failure:function(b,c,e){d.onFormSubmitFailure(a,c,b,e),d.onRequestFailure(a,b)}});var e=function(){b.submit(c),d.onFormSubmitting(a,b,c)};this.beforeFormSubmit(a,b,c,e)!==!1&&e()},beforeFormSubmit:function(){},onFormSubmitting:function(){},onFormSubmitSuccess:function(a,b,c){var d=[],e=this;if(c.msg&&SF.isString(c.msg))d.push(c.msg);else{var f=e.getActionSuccessMsg&&e.getActionSuccessMsg(a);f&&d.push(f)}this.showResponseMsg(d,"showErr")},onFormSubmitFailure:function(a,b,c){var d=[],e=this;if(c){if(c.msg&&SF.isString(c.msg))d.push(c.msg);else{var f=e.getActionFailureMsg&&e.getActionFailureMsg(a);f&&d.push(f)}e.translateInvalid&&c.inputError&&(d=d.concat(b.getInvalidMsgs()))}else d.push(_("\u4e0e\u670d\u52a1\u5668\u8fde\u63a5\u5931\u8d25!"));this.showResponseMsg(d,"showErr")},wrapDisplayText:function(a){return a},getActionSuccessMsg:function(){return _("\u64cd\u4f5c\u6210\u529f!")},getActionFailureMsg:function(){return _("\u64cd\u4f5c\u5931\u8d25!")},doRequest:function(a,b){b=b||{};var c=this;SF.applyIf(b,{url:this.url,success:function(b,d){c.onAjaxRequestSuccess(a,b,d),c.onRequestSuccess(a,b)},failure:function(b,d){c.onAjaxRequestFailure(a,b,d),c.onRequestFailure(a,b)}});var d=function(){c.onAjaxRequesting(a,b),c.request(b)};this.beforeAjaxRequest(a,b,d)!==!1&&d()},beforeAjaxRequest:function(){},onAjaxRequesting:function(){},onAjaxRequestSuccess:function(a,b){var c=[];if(b.msg&&SF.isString(b.msg))c.push(b.msg);else{var d=this.getActionSuccessMsg&&this.getActionSuccessMsg(a);d&&c.push(d)}this.showResponseMsg(c,"showMsg")},onAjaxRequestFailure:function(a,b){var c=[];if(b)if(b.msg&&SF.isString(b.msg))c.push(b.msg);else{var d=this.getActionFailureMsg&&this.getActionFailureMsg(a);d&&c.push(d)}else c.push(_("\u4e0e\u670d\u52a1\u5668\u8fde\u63a5\u5931\u8d25!"));this.showResponseMsg(c,"showErr")},onRequestSuccess:function(){},onRequestFailure:function(){},showResponseMsg:function(a,b){var c,d=this;if(a&&a.length>0&&d[b]){for(c=a.length;c--;)a[c]=d.wrapDisplayText(a[c]);d[b](a.join("<br />"))}},isAvailiable:function(){return!this.isMgrDestroyed&&!this.mgrDestroying}};var a,b,c,d=["addWindow","request","mask","unmask","showMsg","showErr","doRefresh","startAutoRefresh","resumeAutoRefresh"],e=SF.mgr.BaseMgr.prototype,f=e.isAvailiable;for(e.finishRefresh=e.afterLoad,a=0,b=d.length;b>a;a++)c=d[a],e[c]=e[c].createInterceptor(f);SF.mgr.BaseMgr.prototype.showError=SF.mgr.BaseMgr.prototype.showErr,SF.mgr.BaseMgr.prototype.getInterval=SF.mgr.BaseMgr.prototype.getAutoRefreshInterval,SF.mgr.BaseMgr.prototype.setInterval=SF.mgr.BaseMgr.prototype.setAutoRefreshInterval;var g=null;SF.mgr.BaseMgr.getSingleton=function(){return g||(g=new SF.mgr.BaseMgr({id:"Global"})),g}}(),SF.ns("SF.mgr"),SF.mgr.FormMgr=SF.extend(SF.mgr.BaseMgr,{autoLoad:!0,autoLoadAfterSubmit:!0,autoMask:!0,defaultMessages:{load_wait:_("\u6b63\u5728\u52a0\u8f7d\u6570\u636e,\u8bf7\u7a0d\u5019..."),submit_wait:_("\u6b63\u5728\u8bf7\u6c42\u6570\u636e,\u8bf7\u7a0d\u5019..."),submit_success:_("\u4fdd\u5b58\u6210\u529f!"),submit_failure:_("\u4fdd\u5b58\u5931\u8d25!"),validate_failure:_("\u8868\u5355\u5b58\u5728\u9519\u8bef"),load_failure:_("\u8868\u5355\u52a0\u8f7d\u5931\u8d25")},defaultParams:{load:{opr:"list"},submit:{opr:"modify"}},initMgr:function(){SF.mgr.FormMgr.superclass.initMgr.call(this),this.messages=SF.applyIf(this.messages||{},this.defaultMessages),this.baseParams=SF.applyIf(this.baseParams||this.params||{},this.defaultParams),this.formPanel&&(this.form=this.formPanel.getForm(),this.bindAction(this.formPanel,"form")),this.autoLoad&&(this.autoLoadHandle=function(){this.autoLoadHandle=null,this.onFormLoad()
}.defer(1,this))},onFormLoad:function(){this.load({waitMsg:this.autoMask?this.messages.load_wait:void 0,waitMsgTarget:this.page?this.page.getContainer():void 0})},onFormLoadSuccess:function(a){SF.isString(a.msg)&&SF.showMsg(a.msg)},onFormLoadFailure:function(a){SF.showErr(a&&SF.isString(a.msg)?a.msg:this.messages.load_failure)},onFormSubmit:function(){this.form.validate()?this.submit({waitMsg:this.autoMask?this.messages.submit_wait:void 0,waitMsgTarget:this.page?this.page.getContainer():void 0}):SF.showErr([this.messages.validate_failure].concat(this.form.getInvalidMsgs()),!1)},onFormSubmitSuccess:function(a){SF.showMsg(SF.isString(a.msg)?a.msg:this.messages.submit_success),this.autoLoadAfterSubmit&&this.onFormLoad()},onFormSubmitFailure:function(a){var b=[];a?(b.push(SF.isString(a.msg)?a.msg:this.messages.submit_failure),this.translateInvalid&&a.inputError&&(b=b.concat(this.form.getInvalidMsgs()))):b.push(this.messages.submit_failure),SF.showErr(b,!1)},load:function(a){var b={},c=this.getParams("load");SF.isString(a)?b.url=a:SF.isObject(a)&&(b=a),SF.applyIf(b,{url:this.url,params:c,success:this.onFormLoadSuccess,failure:this.onFormLoadFailure,scope:this}),this.form.load(b)},submit:function(a){var b={},c=this.getParams("submit");SF.isString(a)?b.url=a:SF.isObject(a)&&(b=a),SF.applyIf(b,{url:this.url,params:c,success:this.onFormSubmitSuccess,failure:this.onFormSubmitFailure,scope:this}),this.form.submit(b)},getParams:function(a){var b={};return SF.applyIf(b,this.baseParams[a]),b},destroyMgr:function(){this.autoLoadHandle&&(window.clearTimeout(this.autoLoadHandle),this.autoLoadHandle=null),SF.mgr.FormMgr.superclass.destroyMgr.apply(this,arguments)}}),Ext.ns("SF.mgr"),SF.mgr.GridMgr=Ext.extend(SF.mgr.BaseMgr,{mgrType:"grid",initMgr:function(){if(SF.mgr.GridMgr.superclass.initMgr.apply(this,arguments),this.grid||SF.log("GPM: error no grid be set..."),this.formWindow&&(this.regForm("add",this.formWindow),this.regForm("modify",this.formWindow),this.page===this&&this.formWindow.autoFit===!0&&(this.formWindow.autoFit=this.page.getXName()+"#formWindow")),this.filterWindow&&(this.regForm("filter",this.filterWindow),this.page===this&&this.filterWindow.autoFit===!0&&(this.filterWindow.autoFit=this.page.getXName()+"#filterWindow")),this.url||(this.url=this.grid?this.grid.getUrl():null,this.page&&(this.url=this.url||this.page.url)),this.grid){var a=this.prefix||this.getKey(this.grid);this.bindAction(this.grid,a,this.preProcessAction,this),!this.grid.enableAutoError&&this.grid.store&&this.grid.store.on("loadexception",this.readGridException,this)}},getKey:function(a){return a.name?a.name:"grid"},regForm:function(a,b){this.forms||(this.forms={}),this.forms[a]=b,this.addWindow(b)},getForm:function(a){var b=this.forms[a];return b?b:(SF.log('GPM: error no from for "'+a+'" to action.'),null)},convertTbarEnable:function(a,b){var c=a;return"tbar"!==b.src&&(c="enable"==a?"disable":"enable"),c},preProcessAction:function(a,b,c){switch(SF.log("GPM: pre process action. "+a),b.event=c,a){case"moveup":case"movedown":case"delete":case"export":case"import":break;case"enable":case"disable":a=this.convertTbarEnable(a,b);break;default:SF.log('GPM: action "'+a+'", rs: "'+b.rs+'", no handler.')}return[b.grid,b.rs,b,a]},getNameFromRecords:function(a){var b=[],c=this.nameFields;if(SF.isArray(c))for(var d=0;d<c.length;d++){var e=this.getKeyFromRecords(c[d],a);if(e)for(var f=0;f<e.length;f++)b[f]?b[f]+=e[f]?"_#_"+e[f]:"_#_":b[f]=e[f]?e[f]:""}else b=SF.isString(c)?this.getKeyFromRecords(c,a):this.getKeyFromRecords("name",a);return b},getKeyFromRecords:function(a,b){if(!b)return null;for(var c=[],d=0;d<b.length;d++){var e=b[d].get(a);"undefined"!=typeof e&&c.push(e)}return c},getKeyFromNodes:function(a,b){if(!b)return null;for(var c,d=[],e=0;c=b[e];e++)d.push(c.attributes[a]);return d},setFormOpt:function(a,b){return b},openForm:function(a,b,c){var d=this.getForm(b);if(!d)return!1;var e={value:a,confirm:function(a){SF.isString(c)?c={url:c}:SF.isObject(c)||(c={});var e=SF.applyIf(c,{waitMsg:!0,url:this.url,params:{opr:b},failure:function(b){var c=[_("\u8868\u5355\u63d0\u4ea4\u51fa\u9519")];return b&&(b.msg&&c.push(b.msg),this.translateInvalid&&b.inputError&&(c=c.concat(a.getInvalidMsgs()))),c.length>0&&this.showErr(c,!1),!1},success:function(a,b,c){return d.afterSave(),this.showMsg(a.msg||_("\u8868\u5355\u63d0\u4ea4\u6210\u529f")),this.reload(c),!0},scope:this});return this.modifyParams(e),a.submit(e),!1},scope:this};d.open(this.setFormOpt(b,e))},modifyParams:function(a){return Ext.apply(a,{})},onLoad:function(a){if(SF.isObject(a)){if(SF.isFunction(a.reload))return a.reload();if(SF.isObject(a.src)){if(SF.isFunction(a.src.reload))return a.src.reload();SF.log("GM: input o no reload & src no reload method.")}else SF.log("GM: input o no reload & no src.")}return a=a||{},this.grid?this.grid.store[this.grid.store.remoteReload?"remoteReload":"reload"]({callback:this.finishRefresh,scope:this}):SF.log("GM: no grid, no src to reload.")},onGridAdd:function(a,b,c,d){var e=this.createNewRecord();return this.openForm(e.data,d,c)},onStartEditor:function(a,b,c){return this.openForm(a.data,c,null)},onGridModify:function(a,b){var c=this.getNameFromRecords(b),d=c[0]?c[0]:"",e=b[0]?b[0].data:null;this.doRequest("listItem",a,b,{params:{opr:"listItem",name:d,oldData:e}})},onGridImport:function(a,b,c,d){this.doRequest(d,a,b,{params:{opr:d,file:c.fileId}})},onGridExport:function(a,b,c,d){this.doRequest(d,a,b)},onGridEnable:function(a,b,c,d){"enable"==d?this.doRequest(d,a,b):this.doRequest(d,a,b,null,!0,_("\u786e\u8ba4\u8981\u6267\u884c\u7981\u7528\u64cd\u4f5c"))},onGridDisable:function(a,b,c,d){"disable"==d?this.doRequest(d,a,b):this.doRequest(d,a,b,null,!0,_("\u786e\u8ba4\u8981\u6267\u884c\u542f\u7528\u64cd\u4f5c"))},onGridMovedown:function(a,b,c,d){var e=a.getSelectionModel();return e.isSelected(a.getStore().getTotalCount()-1)?void this.showErr(_("\u6700\u540e\u4e00\u4e2a\u5bf9\u8c61\u4e0d\u5141\u8bb8\u8fdb\u884c\u4e0b\u79fb\u64cd\u4f5c"),_("\u4e0b\u79fb\u5bf9\u8c61\u51fa\u9519")):void this.doRequest(d,a,b)},onGridMoveup:function(a,b,c,d){return 0==a.getStore().indexOf(b[0])?void this.showErr(_("\u7b2c\u4e00\u4e2a\u5bf9\u8c61\u4e0d\u5141\u8bb8\u8fdb\u884c\u4e0a\u79fb\u64cd\u4f5c"),_("\u4e0a\u79fb\u5bf9\u8c61\u51fa\u9519")):void this.doRequest(d,a,b)},onGridDelete:function(a,b,c,d){this.doRequest(d,a,b,null,!0,_("\u786e\u8ba4\u8981\u6267\u884c\u5220\u9664\u64cd\u4f5c?"))},onGridRefresh:function(){this.grid&&(this.grid.loadMask||this.grid.store.on({scope:this,beforeload:this.onGridRefreshBeforeLoad,load:this.onGridRefreshLoad,exception:this.onGridRefreshLoad})),this.reload()},onGridRefreshBeforeLoad:function(){this.grid&&this.grid.rendered&&this.grid.bwrap.mask(_("\u6b63\u5728\u52a0\u8f7d\u6570\u636e\uff0c\u8bf7\u7a0d\u5019..."),"x-mask-loading")},onGridRefreshLoad:function(){this.grid&&this.grid.rendered&&(this.grid.bwrap.unmask(),this.grid.store.un("beforeload",this.onGridRefreshBeforeLoad,this),this.grid.store.un("load",this.onGridRefreshLoad,this),this.grid.store.un("exception",this.onGridRefreshLoad,this))},onGridFilter:function(a,b,c,d){if(!this.filterWindow)return SF.log("GPM: filter window not configured for - "+d),!1;var e=this.grid.getFilter();return this.filterWindow.open({value:e,confirm:this.filterConfirm,scope:this}),!0},filterConfirm:function(a){var b=a.getJsonValue();return b&&(this.grid.setFilter(b),this.reload()),!0},onGridSetfilter:function(a,b,c){var d=c.append?c.append:!0;this.grid.setFilter(b,d)&&this.reload()},setParams:function(a,b,c){var b=this.getNameFromRecords(b),d=SF.applyIf(c,{params:{opr:a,name:b}});return d},requestData:function(a,b,c){if(b){var d=arguments.callee;return Ext.Msg.confirm(_("\u64cd\u4f5c\u786e\u8ba4"),c?c:_("\u786e\u8ba4\u6267\u884c\u6b64\u64cd\u4f5c?"),function(b){return"yes"==b?d.call(this,a,!1):!1},this),!1}SF.isObject(a)||(a={});var e=SF.applyIf(a,{url:this.url||"cgi-bin/emptyPage.php",waitMsg:!0,callback:this.responseCallback,scope:this});return this.request(e)},doRequest:function(a,b,c,d,e,f){SF.isObject(d)||(d={});var g=this.setParams(a,c,d);this.requestData(g,e,f)},readGridException:function(a,b,c){var d=[_("\u6570\u636e\u52a0\u8f7d\u5931\u8d25.")];try{if(c.status<=0)return SF.invoke("networkerror"),!0;var e=c.getJsonData&&c.getJsonData()||Ext.decode(c.responseText);e.msg&&d.push(e.msg),e.inputError&&d.push(e.inputError)}catch(f){return this.showErr(d.join("")),!0}return this.showErr(d),!0},responseCallback:function(a,b,c){if(!a)return SF.invoke("networkerror"),!1;if(!a.success){var d=[];return d.push(a.msg&&a.msg.length>0?a.msg:_("\u64cd\u4f5c\u5931\u8d25")),this.showErr(d.join("<br>")),!1}var e=c.params.opr;return e?this.handleResponse(a,e,c)?this.handleResponseFinished(a,e,c):!1:(this.showErr(_("\u89e6\u53d1\u4e8b\u4ef6\u4e22\u5931.")),!1)},handleResponse:function(){return!0},handleResponseFinished:function(a,b,c){var d=[_("\u64cd\u4f5c\u6210\u529f")];switch(b){case"moveup":case"movedown":case"enable":case"disable":case"delete":case"import":a.msg&&d.push(a.msg),this.showMsg(d),this.reload(c);break;case"listItem":this.onStartEditor(a,c,"modify");break;case"export":SF.loadFile(a.url);break;default:SF.log("GPM: first request ret: "+b)}return!0},createNewRecord:function(a){return this.grid.createRecord(a)}}),Ext.ns("SF.page"),SF.page.AbstractPage=SF.AbstractPage=function(a){SF.AbstractPage.superclass.constructor.call(this),SF.log(this.getXName()+" create."),this.initialConfig=Ext.apply({},a),this.applyConfig(a),this.container=null,this.page=this,this.addEvents("activate","deactivate","beforeclose","beforedestroy","destroy"),this.bActive=!1,this.on({activate:function(){this.bActive=!0},deactivate:function(){this.bActive=!1}})},SF.AbstractPage.xname="AbstractPage",Ext.extend(SF.AbstractPage,Ext.util.Observable,{beforeInit:function(){return!0},onInit:SF.emptyFn,onLayout:SF.emptyFn,afterLayout:SF.emptyFn,onDestroy:SF.emptyFn,addWindow:function(a){a.setRelatedComponent&&a.setRelatedComponent(this.container)},init:function(){this.onInit(),this.inited=!0,SF.debugMode&&SF.debug&&SF.debug.monitor(this,this.getXName())},layout:function(){this.title&&this.setTitle(this.title),this.onLayout(this.container),this.rendered=!0},afterWrapLayout:function(){this.layoutDone=!0,this.masked&&this.mask.apply(this,this.maskedArgus),this.afterLayout.apply(this,arguments)},applyConfig:function(a){a&&Ext.copyTo(this,a,["params","closable","simpleView","autoRefresh"])},getOpenConfig:function(){var a={};return Ext.copyTo(a,this,["params","closable","simpleView","autoRefresh"]),a},destroy:function(a){this.isDestroyed||this.fireEvent("beforedestroy",this)!==!1&&(this.destroying=!0,this.container&&this.container.isDestroyed!==!0&&this.container.destroying!==!0&&(a=parseInt(a,10)||0,a>0?SF.debugMode?Ext.destroy(this.container):(this.container.hide(),Ext.destroy.defer(a,Ext,[this.container])):Ext.destroy(this.container)),delete this.container,delete this.initialConfig,this.onDestroy(),this.fireEvent("destroy",this),this.purgeListeners(),SF.log("["+this.getXName()+"] destroy."),this.destroying=!1,this.isDestroyed=!0)},setTitle:function(a){if(this.container){if(this.container.setTitle)return this.container.setTitle(a);this.container.title=a,this.container.fireEvent("titlechange",this.container,a)}this.title=a},getContainer:function(){return this.container},setContainer:function(a){this.container=a},onSuspend:SF.emptyFn,onResume:SF.emptyFn,suspend:function(){this.recycled||(SF.log(this.getXName()+" recycle."),this.onSuspend(),this.container.hide(),delete this.container.closable,delete this.closable,this.recycled=!0)},resume:function(a){this.recycled&&(SF.log(this.getXName()+" reuse."),this.onResume(),a===!0&&this.container.show(),this.recycled=!1)},onReloadData:SF.emptyFn,reloadData:function(a){this.params=a||this.params,this.recycled&&this.resume(),this.onReloadData(),SF.log(this.getXName()+" reload.")},mask:function(){var a;return this.masked=!0,this.maskedArgus=Ext.toArray(arguments),!this.isDestroyed&&this.layoutDone?(a=this.getContainer().getEl(),a.mask.apply(a,arguments)):void 0},unmask:function(){return this.masked=!1,delete this.maskedArgus,!this.isDestroyed&&this.layoutDone?this.getContainer().getEl().unmask():void 0},isMasked:function(){return this.masked},isActive:function(){return this.bActive},isSingleton:function(){return!!this.constructor.singleton},getXName:function(){return this.constructor.xname},getGroupName:function(){return"group-"+ +new Date},getHelpURI:function(){var a=this.constructor.help;return a&&a.indexOf(":")<0&&(a+=":"),a||null}}),SF.copyTo(SF.AbstractPage.prototype,Ext.Component.prototype,["purgeListeners","clearMons","createMons","mon","mun"]),SF.BasePage=SF.page.BasePage=SF.extend(SF.page.AbstractPage,{onInit:function(){SF.BasePage.superclass.onInit.apply(this,arguments),this.initMgr()}}),SF.applyInterface(SF.BasePage,SF.mgr.BaseMgr),SF.FormPage=SF.page.FormPage=SF.extend(SF.AbstractPage,{enterSubmit:!1,constructor:function(){this.params&&(this.baseParams=this.params),SF.page.FormPage.superclass.constructor.apply(this,arguments)},onInit:function(){SF.FormPage.superclass.onInit.apply(this,arguments),this.wraped=!0,this.isFitLayout=!0;var a=Ext.apply({},this.formPanelCfg),b={title:this.formTitle,layout:this.formLayout,height:this.height,maxHeight:this.maxHeight,width:this.width,buttons:this.buttons};SF.applyIf(a,b),(this.height>0||this.width>0)&&(this.isFitLayout=!1),SF.apply(a,{form:new this.formClass(this.formCfg),enableButtonAction:!0,baseCls:"x-formpage"}),SF.applyIf(a,{buttonAlign:"right",buttons:[{text:_("\u63d0\u4ea4"),actionName:"submit"}]}),this.formPanel=new SF.form.FormPanel(a),this.formPanel.autoFit===!0&&(this.formPanel.autoFit=this.getXName()+"#formPage"),this.enterSubmit&&this.formPanel.on("render",function(){this.formPanel.mon(this.formPanel.el,Ext.EventManager.useKeydown?"keydown":"keypress",function(a){a.getKey()==a.ENTER&&(Ext.fly(a.getTarget()).is("textarea")||this.onFormSubmit())},this)},this),this.page=this,this.initMgr()},onLayout:function(){SF.FormPage.superclass.onLayout.apply(this,arguments);var a,b,c=this.container;c.add(this.formPanel),this.wraped&&(a="x-formpage-wraped",b=function(){c.getLayoutTarget().addClass(a)},c.rendered?b():c.on("render",b,this,{single:!0}))}}),SF.applyInterface(SF.FormPage,SF.mgr.FormMgr),SF.GridPage=SF.page.GridPage=SF.extend(SF.AbstractPage,{enableActionDispatch:!0,local:!1,nameFields:null,onInit:function(){SF.GridPage.superclass.onInit.apply(this,arguments),this.initGridPage(),this.initMgr&&(this.page=this,this.initMgr())},onLayout:function(){SF.GridPage.superclass.onLayout.apply(this,arguments),this.container.add(this.grid)}}),SF.applyInterface(SF.GridPage,SF.mgr.GridMgr),function(){var a=[],b=function(b){Ext.isArray(b)?a=a.concat(b):a.push(b)},c=function(b){for(var c=a.length;c-->0;)if(b.indexOf(a[c])>-1)return!0;return!1};SF.core.regInvoke("ajaxisskip",c),SF.core.regInvoke("ajaxskipxregist",b);var d=Ext.extend(Object,{constructor:function(a){a=this.invokeMap=a||{};var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b);this.hookList=c},hook:function(a){a&&a.on&&(a.on("beforerequest",this._processBeforeRequest,this),a.on("requestcomplete",this._processResponse,this))},_processBeforeRequest:function(a,b){var c=b.url;c+="?s="+ACDC.data.token,b.url=c},_processResponse:function(a,b,d){var e,f,g,h,i,j=this.hookList,k=this.invokeMap;if(c(d.url))return!0;if(e=b.getJsonData())for(f=0;f<j.length;f++)g=j[f],i=k[g],e.hasOwnProperty(g)&&(h=e[g])&&(Ext.isString(i)?SF.invoke(i,h):Ext.isFunction(i)&&i(h))}});Ext.ns("SF.framework.feature"),SF.framework.feature.AjaxHooker=d}(),function(){var a=Ext.extend(Object,{constructor:function(a){Ext.apply(this,a)},init:function(){var a=Ext.fly("nav");a&&(a.on("click",this._handleContextClick,this),a.on("contextmenu",this._handleContextClick,this));var b=Ext.fly("sf_main_tabpanel");b&&(b.on("click",this._handleContextClick,this),b.on("contextmenu",this._handleContextClick,this))},_handleContextClick:function(a){var b,c,d,e,f,g=a.getTarget("a"),h=this.matchers;if(g&&(b=g.getAttribute("href",2)))for(c=0,d=h.length;d>c;c++)if(e=h[c],f=b.match(e.regex))return e.fn.call(e.scope,a,g,f);Ext.isIE8&&0===a.button&&(g=a.getTarget("span.sim-link[href]"),g&&"_blank"===g.target&&window.open(g.href))}});Ext.ns("SF.framework.feature"),SF.framework.feature.LinkInterceptor=a}(),function(){var a=new SF.framework.feature.AjaxHooker({needRelogin:"dologin",noPermission:"nopermission",needReboot:"needreboot"});a.hook(Ext.Ajax)}(),Ext.ns("SF.framework.features"),SF.framework.features.BackspacePreventer=Ext.extend(Object,{init:function(){Ext.getDoc().on({keydown:function(a){var b=a.getKey(),c=a.getTarget();b===a.BACKSPACE&&("INPUT"!==c.tagName||"text"!==c.type.toLowerCase()&&"password"!==c.type.toLowerCase()||c.readOnly===!0)&&"TEXTAREA"!==c.tagName&&a.preventDefault()}})}}),SF.core&&SF.core.onReady(function(){SF.framework.features.backspacePreventer=new SF.framework.features.BackspacePreventer,SF.framework.features.backspacePreventer.init()}),Ext.ns("SF.framework.features"),SF.core.onReady(function(){var a=new SF.framework.feature.LinkInterceptor({matchers:[{regex:/#mod=([\/a-zA-Z\d_\-]+)(?:#group=(\w+))?(?:#data=(.*))?$/,fn:function(a,b,c){var d="home"+c[1],e=c[2],f=c[3];if(SF.isString(f))try{f=Ext.decode(f)}catch(g){f={}}return SF.isObject(f)||(f={}),"newTab"in f||(f.newTab=!0),"contextmenu"===a.type||2===a.button?SF.invoke("pagelinkmenu",d,e,f,a):SF.invoke("openpage",d,e,f),!1}}]});a.init()}),function(){var a=Ext.extend(Object,{init:function(){Ext.QuickTips.init(),Ext.apply(Ext.QuickTips.getQuickTip(),{dismissDelay:0,interceptTitles:!0,minWidth:70,getTipCfg:function(a){var b,c,d=a.getTarget();if(this.interceptTitles&&d.title&&Ext.isString(d.title)){if(b=d.title,b&&b.replace){if(b.length<=512)return;b=Ext.util.Format.htmlEncode(b),b=b.replace(/\r?\n/g,"<br />")}d.qtip=b,d.removeAttribute("title"),a.preventDefault()}else c=this.tagConfig,b=d.qtip||Ext.fly(d).getAttribute(c.attribute,c.namespace);return b}})}});Ext.ns("SF.framework.features"),SF.framework.features.QuickTip=a}(),SF.core&&SF.core.onReady(function(){SF.framework.features.quickTip=new SF.framework.features.QuickTip,SF.framework.features.quickTip.init()}),function(){var a=!1,b=function(b){a||(b&&"string"==typeof b||(b=_("\u65e5\u5fd7\u4e2d\u5fc3\u64cd\u4f5c\u8d85\u65f6\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\uff01")),a=!0,location.href=ACDC.data.isLinux?"./login.html":"./login.php")};SF.core.regInvoke("dologin",b)}();