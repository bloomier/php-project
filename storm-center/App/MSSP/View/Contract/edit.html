<include file="./App/MSSP/View/header.html" />
<link href="__PUBLIC__/js/zTree_v3/css/zTreeStyle/zTreeStyle.css" rel="stylesheet" type="text/css" />

<input type="hidden" value="{$pmlist}" id="pmListSrc">
<input type="hidden" value="{$salers}" id="salerListSrc">
<input type="hidden" value="{$customerSrc}" id="customerListSrc">
<input type="hidden" value="{$contactList}" id="contactListSrc">
<input type="hidden" value="{$contractInfoSrc}" id="contractInfoSrc">
<input type="hidden" value="{$domainListSrc}" id="domainListSrc">
<input type="hidden" value="{$alertListSrc}" id="alertListSrc">

<style>
    .config_param{
        display: none;border-style:solid; border-width:1px; border-color:#000;margin-top:10px;margin-bottom:10px;padding:20px;
    }
</style>

<div class="main">
    <div class="m-inner">
        <!-- BEGIN PAGE HEADER-->
        <div class="row">
            <div class="col-md-12">
                <div class="portlet box blue form_wizard_1">
                    <div class="portlet-title">
                        <div class="caption"><i class="icon-comments"></i><span class="page_desc">新增合同</span></div>
                    </div>
                    <div class="portlet-body form">
                        <div class="row">
                            <div class="col-md-12">
                                <form action="#" class="form-horizontal"  id="form_wizard">
                                    <div class="form-wizard">
                                        <div class="row steps">
                                            <ul class="nav-justified step" style="border: hidden">
                                                <li class="span3 text-center active col-sm-offset-1">
                                                    <a href="#tab_1" class="step active"data-toggle="tab">
                                                        <span class="number">1</span>
                                                        <span class="desc"><i class="icon-ok"></i>合同信息</span>
                                                    </a>
                                                </li>
                                                <li class="span3 text-center col-sm-offset-1">
                                                    <a href="#tab_3" class="step" data-toggle="tab">
                                                        <span class="number">2</span>
                                                        <span class="desc"><i class="icon-ok"></i>告警联系人</span>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="row margin-top-20">
                                            <div class="col-md-12">
                                                <div class="progress">
                                                    <div class="progress-bar progress-bar-striped bar" role="progressbar" style="width: 50%;">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-content" style="padding:10px">
                                            <div class="tab-pane active" id="tab_1">
                                                <h3>合同信息</h3><hr>
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label"><span class="required">*</span>合同编号</label>
                                                    <div class="col-sm-6">
                                                        <input type="text" class="form-control m-wrap" id="contract_id">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label"><span class="required">*</span>合同名称</label>
                                                    <div class="col-sm-6">
                                                        <input type="text" class="form-control m-wrap" id="contract_name">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label"><span class="required">*</span>客户名称</label>
                                                    <div class="col-sm-6">
                                                        <select class="m-wrap"  style="width: 100%;" id="customer_name">

                                                        </select>
                                                    </div>
                                                </div>

                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label"><span class="required">*</span>项目期限</label>
                                                    <div class="col-sm-2">
                                                        <input type="text" class="Wdate form-control m-wrap" style="width: 100%" onfocus="WdatePicker()" id="contract_begin" />
                                                    </div>
                                                    <label class="col-sm-2 control-label" style="text-align: center;">至</label>
                                                    <div class="col-sm-2">
                                                        <input type="text" class="Wdate form-control m-wrap" style="width: 100%" onFocus="var minDate=$('#contract-begin').val(); WdatePicker({minDate:minDate})" id="contract_end" />
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label"><span class="required">*</span>项目经理</label>
                                                    <div class="col-sm-6">
                                                        <select class="m-wrap"  style="width: 100%;" id="contract_pm">
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label"><span class="required">*</span>销售人员</label>
                                                    <div class="col-sm-6">
                                                        <select class="m-wrap"  style="width: 100%;" id="contract_saler">
                                                        </select>
                                                    </div>
                                                </div>
                                                <h3>监测站点</h3><hr>
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label"><span class="required">*</span>监测站点</label>
                                                    <div class="col-sm-6 contract_domain_list_wrapper">
                                                        <div id="contract_domain_list_wrapper"  style="display: none;height: 200px;overflow-y:scroll;">
                                                            <table class="table">
                                                                <thead>
                                                                <tr>
                                                                    <td style="width: 15%">协议</td>
                                                                    <td style="width: 30%">域名</td>
                                                                    <td style="width: 15%">端口</td>
                                                                    <td style="width: 40%">ip</td>
                                                                </tr>
                                                                </thead>
                                                                <tbody>
                                                                <tr>
                                                                    <td><select><option value="http" checked>http</option><option value="https">https</option></select></td>
                                                                    <td><p contenteditable="true">域名</p></td>
                                                                    <td><p contenteditable="true">端口</p></td>
                                                                    <td><p contenteditable="true">防护网站公网真实IP</p></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><select><option value="http" checked>http</option><option value="https">https</option></select></td>
                                                                    <td><p contenteditable="true">域名</p></td>
                                                                    <td><p contenteditable="true">端口</p></td>
                                                                    <td><p contenteditable="true">防护网站公网真实IP</p></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><select><option value="http" checked>http</option><option value="https">https</option></select></td>
                                                                    <td><p contenteditable="true">域名</p></td>
                                                                    <td><p contenteditable="true">端口</p></td>
                                                                    <td><p contenteditable="true">防护网站公网真实IP</p></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><select><option value="http" checked>http</option><option value="https">https</option></select></td>
                                                                    <td><p contenteditable="true">域名</p></td>
                                                                    <td><p contenteditable="true">端口</p></td>
                                                                    <td><p contenteditable="true">防护网站公网真实IP</p></td>
                                                                </tr>
                                                                <tr>
                                                                    <td><select><option value="http" checked>http</option><option value="https">https</option></select></td>
                                                                    <td><p contenteditable="true">域名</p></td>
                                                                    <td><p contenteditable="true">端口</p></td>
                                                                    <td><p contenteditable="true">防护网站公网真实IP</p></td>
                                                                </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                        <textarea class="form-control m-wrap"  rows="6" id="contract-domain-list"   style="text-align:left; padding:auto; margin:auto;resize: none;">

                                                        </textarea>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label">服务套餐</label>
                                                    <div class="controls">
                                                        <div class="col-sm-8">
                                                            <input type="checkbox" value="vuls-scan" class="server_type_check_box" id="vuls-scan" sub_div="web-scan-config-div">漏洞扫描<br>
                                                            <div class="config_param" id="web-scan-config-div">
                                                                <div class="form-group">
                                                                    <label class="control-label col-sm-3"><span style="color: red">*</span>扫描节点</label>
                                                                    <div class="col-sm-8">
                                                                        <select style="width:100%" class="policy-level" id="task-node">
                                                                            <volist name="nodes" id="vo" key="k" >
                                                                                <option value="{$vo.id}">{$vo.name}</option>
                                                                            </volist>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label class="control-label col-sm-3"><span style="color: red">*</span>扫描策略组</label>
                                                                    <div class="col-sm-8">
                                                                        <select style="width:100%" class="policy-level" id="policy-group">
                                                                            <volist name="policy_group" id="vo" key="k" >
                                                                                <option value="{$vo.id}">{$vo.name}</option>
                                                                            </volist>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label class="control-label col-sm-3"><span style="color: red">*</span>扫描层级</label>
                                                                    <div class="col-sm-8">
                                                                        <select style="width:100%" class="policy-level" id="task-level">
                                                                            <option value="1">1</option>
                                                                            <option value="2">2</option>
                                                                            <option value="3" selected>3</option>
                                                                            <option value="4">4</option>
                                                                            <option value="5">5</option>
                                                                            <option value="6">6</option>
                                                                            <option value="7">7</option>
                                                                            <option value="8">8</option>
                                                                            <option value="9">9</option>
                                                                            <option value="10">10</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label class="control-label col-sm-3"><span style="color: red">*</span>最小处理单位</label>
                                                                    <div class="col-sm-8">
                                                                        <select style="width:100%" class="policy-level" id="task-min-slip">
                                                                            <option value="10">10</option>
                                                                            <option value="20">20</option>
                                                                            <option value="50">50</option>
                                                                            <option value="100">100</option>
                                                                            <option value="300">300</option>
                                                                            <option value="500" selected>500</option>
                                                                            <option value="1000">1000</option>
                                                                            <option value="5000">5000</option>
                                                                            <option value="10000">10000</option>
                                                                            <option value="15000">15000</option>
                                                                            <option value="20000">20000</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group audit_button">
                                                                    <label class="control-label col-sm-3">扫描周期</label>
                                                                    <div class="col-sm-8 row">
                                                                        <label class="col-sm-5 " style="font-size: 12px;">
                                                                            <span style="line-height: 16px;">
                                                                                <input type="radio" name="task-cycle" value="0" data-title="">
                                                                            </span>
                                                                            一次
                                                                        </label>
                                                                        <label class="col-sm-5 " style="font-size: 12px;">
                                                                            <span style="line-height: 16px;" class="checked">
                                                                                <input type="radio" name="task-cycle" checked value="1" data-title="">
                                                                            </span>
                                                                            循环
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group cyc-day-div">
                                                                    <label class="control-label col-sm-3">扫描间隔天数</label>
                                                                    <div class="col-sm-8">
                                                                        <select style="width:100%"  id="taskCycDay">
                                                                            <option value="1">1</option>
                                                                            <option value="3">3</option>
                                                                            <option value="5">5</option>
                                                                            <option value="7">7</option>
                                                                            <option value="15">15</option>
                                                                            <option value="30">30</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <input type="checkbox" value="security-scan" class="server_type_check_box" id="security-scan" sub_div="security-event-config-div">安全事件监测<br>
                                                            <div class="config_param" id="security-event-config-div">
                                                                <div class="form-group">
                                                                    <label class="control-label col-sm-3"><span style="color: red">*</span>扫描节点</label>
                                                                    <div class="col-sm-8">
                                                                        <select style="width:100%" class="policy-level" id="event-task-node">
                                                                            <volist name="nodes" id="vo" key="k" >
                                                                                <option value="{$vo.id}">{$vo.name}</option>
                                                                            </volist>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label class="control-label col-sm-3"><span style="color: red">*</span>扫描策略组</label>
                                                                    <div class="col-sm-8">
                                                                        <select style="width:100%" class="policy-level" id="event-policy-group">
                                                                            <volist name="policy_group" id="vo" key="k" >
                                                                                <option value="{$vo.id}">{$vo.name}</option>
                                                                            </volist>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label class="control-label col-sm-3"><span style="color: red">*</span>扫描层级</label>
                                                                    <div class="col-sm-8">
                                                                        <select style="width:100%" class="policy-level" id="event-task-level">
                                                                            <option value="1">1</option>
                                                                            <option value="2">2</option>
                                                                            <option value="3" selected>3</option>
                                                                            <option value="4">4</option>
                                                                            <option value="5">5</option>
                                                                            <option value="6">6</option>
                                                                            <option value="7">7</option>
                                                                            <option value="8">8</option>
                                                                            <option value="9">9</option>
                                                                            <option value="10">10</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label class="control-label col-sm-3"><span style="color: red">*</span>最小处理单位</label>
                                                                    <div class="col-sm-8">
                                                                        <select style="width:100%" class="policy-level" id="event-task-min-slip">
                                                                            <option value="10">10</option>
                                                                            <option value="20">20</option>
                                                                            <option value="50">50</option>
                                                                            <option value="100">100</option>
                                                                            <option value="300">300</option>
                                                                            <option value="500" selected>500</option>
                                                                            <option value="1000">1000</option>
                                                                            <option value="5000">5000</option>
                                                                            <option value="10000">10000</option>
                                                                            <option value="15000">15000</option>
                                                                            <option value="20000">20000</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group audit_button">
                                                                    <label class="control-label col-sm-3">扫描周期</label>
                                                                    <div class="col-sm-8 row">
                                                                        <label class="col-sm-5" style="font-size: 12px;">
                                                                            <span style="line-height: 16px;">
                                                                                <input type="radio" name="event-task-cycle" value="1" checked data-title="">
                                                                            </span>
                                                                            循环
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group event-cyc-day-div">
                                                                    <label class="control-label col-sm-3">扫描间隔天数</label>
                                                                    <div class="col-sm-8">
                                                                        <select style="width:100%"  id="eventTaskCycDay">
                                                                            <option value="1">1</option>
                                                                            <option value="3">3</option>
                                                                            <option value="5">5</option>
                                                                            <option value="7">7</option>
                                                                            <option value="15">15</option>
                                                                            <option value="30">30</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <input type="checkbox" value="server-check" class="server_type_check_box" id="server-check" sub_div="web-server-config-div">服务监测<br>
                                                            <div class="config_param" id="web-server-config-div">
                                                                <div class="form-group">
                                                                    <label class="control-label col-sm-3"><span style="color: red">*</span>服务套餐</label>
                                                                    <div class="col-sm-8">
                                                                        <select style="width:100%" class="policy-level" id="">
                                                                            <option value="1">全方位扫描</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <input type="checkbox" value="cloud-waf" class="server_type_check_box" id="cloud-waf" sub_div="web-waf-config-div">云防护<br>
                                                            <div class=" config_param" id="web-waf-config-div">
                                                                <div class="form-group">
                                                                    <label class="control-label col-sm-3"><span style="color: red">*</span>规则</label>
                                                                    <div class="col-sm-8">
                                                                        <select style="width:100%" class="policy-level">
                                                                            <option value="1">预设规则</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label class="control-label col-sm-3"><span style="color: red">*</span>表格行数</label>
                                                                    <div class="col-sm-8">
                                                                        <select style="width:100%" class="cloud_waf_tr_size">
                                                                            <option value="1">1</option>
                                                                            <option value="5" selected>5</option>
                                                                            <option value="10">10</option>
                                                                            <option value="50">50</option>
                                                                            <option value="100">100</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="tab-pane" id="tab_3">
                                                <div class="row margin-bottom-15">
                                                    <div class="col-sm-10 col-sm-offset-1">
                                                        <div class="inline">
                                                            <a  class="btn btn-add-user"><i class="fa fa-plus"></i>
                                                                添加联系人
                                                            </a>
                                                            <a class="btn btn-chose-user"><i class="fa fa-pencil-square-o"></i>
                                                                选择联系人
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-10 col-sm-offset-1">
                                                        <div id="table-wraper">
                                                            <table class="table table-striped table-bordered table-hover dataTable" id="contract_contact_table">
                                                                <thead class="bg-lightgrey">
                                                                <tr role="row">
                                                                    <td>姓名</td>
                                                                    <td>手机号</td>
                                                                    <td>邮箱</td>
                                                                    <td>通知方式</td>
                                                                    <td>操作</td>
                                                                </tr>
                                                                </thead>
                                                                <tbody class="contract-contact-table-list">
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-actions clearfix">
                                            <a href="javascript:;" class="btn button-previous" style="display: none">
                                                <i class="m-icon-swapleft"></i>上一步
                                            </a>
                                            <a href="javascript:;" class="btn blue button-next">
                                                下一步<i class="m-icon-swapright m-icon-white"></i>
                                            </a>
                                            <a href="javascript:;" class="btn green button-submit"  style="display: none">
                                                提交<i class="m-icon-swapright m-icon-white"></i>
                                            </a>
                                        </div>
                                    </div>
                                </form>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<div class="modal fade bs-example-modal-lg" id="contract_edit_modal" >
    <div class="modal-dialog"  >
        <div class="modal-content">
            <div class="modal-header"  style="background:#828080;border-bottom-width: 0px;">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">编辑联系人</h4>
            </div>
            <div class="modal-body" style="background:#BEBEBE">
                <form class="form-horizontal" id="add_contact_form" action="" data-parsley-validate>
                    <input type="hidden" name="srcTelephone">
                    <div class="form-group">
                        <label  class="col-sm-2 control-label"><span style="color:#ff0000">*</span>电话号码</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" name="telephone">
                        </div>
                    </div>
                    <div class="form-group">
                        <label  class="col-sm-2 control-label"><span style="color:#ff0000">*</span>用户姓名</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" name="username" >
                        </div>
                    </div>
                    <div class="form-group">
                        <label  class="col-sm-2 control-label"><span style="color:#ff0000">*</span>邮箱</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" name="email">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label"><span class="required">*</span>客户名称</label>
                        <div class="col-sm-10">
                            <select class="m-wrap"  style="width: 100%;" name="contact_remark" id="contract_remark">
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label  class="col-sm-2 control-label">通知方式</label>
                        <div class="col-sm-10">
                            <input type="checkbox" class="msgInfo" name="msgInfo">短信通知
                            <input type="checkbox" class="mixinInfo" name="mixinInfo">密信通知
                            <input type="checkbox" class="emailInfo" name="emailInfo">邮件通知
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer alert_domain_footer"   style="background:#828080;border-bottom-width: 0px;">
                <div class="row">
                    <div class="col-md-2" style="text-align: left">
                        <label class="show_number_tag"></label>
                    </div>
                    <div class="col-sm-10" style="text-align: right">
                        <button type="button" class="btn btn-default contract_close" data-dismiss="modal">取消</button>
                        <button type="button" class="btn btn-primary contract_add" style="">添加</button>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<!-- 选择联系人 -->
<div class="modal fade bs-example-modal-lg" id="contract_choose_modal" >
    <div class="modal-dialog"  >
        <div class="modal-content">
            <div class="modal-header"  style="background:#828080;border-bottom-width: 0px;">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">选择联系人</h4>
            </div>
            <div class="modal-body" style="background:#BEBEBE">
                <form class="form-horizontal" id="choseContact">
                    <div class="form-group">
                        <label class="control-label col-sm-2">联系人</label>
                        <div class="col-sm-10">
                            <div class="col-sm-8">
                                <input type="text" class="form-control" name="ztree_param">
                            </div>
                            <div class="col-sm-2">
                                <button class="btn ztree-search">查询</button>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-2"></label>
                        <div class="col-sm-8">
                            <div style="resize: none; height:400px ;overflow:hidden;overflow-y:auto; border:1px solid #000000; margin-left:15px">
                                <ul id="choose_contact_ztree" class="ztree"></ul>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer alert_domain_footer"   style="background:#828080;border-bottom-width: 0px;">
                <div class="row">
                    <div class="col-md-2" style="text-align: left">
                        <label class="show_number_tag"></label>
                    </div>
                    <div class="col-sm-10" style="text-align: right">
                        <button type="button" class="btn btn-default contract_choose_close" data-dismiss="modal">取消</button>
                        <button type="button" class="btn btn-primary contract_choose_add" style="">添加</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<include file="./App/MSSP/View/footer.html" />
<script type="text/javascript" src="__PUBLIC__/js/zTree_v3/js/jquery.ztree.all-3.5.min.js"></script>
<script src="__PUBLIC__/js/My97DatePicker/WdatePicker.js" type="text/javascript"></script>
<script type="text/javascript" src="__PUBLIC__/js/metronic-bootstrap/js/jquery.bootstrap.wizard.js"></script>
<script type="text/javascript" src="__PUBLIC__/script/MSSP/contractedit.js"></script>
